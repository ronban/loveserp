jQuery.sap.declare("sap.rules.ui.parser.resources.common.lib.resourcesConvertor");jQuery.sap.require("sap.rules.ui.parser.resources.common.lib.oDataHandler");sap.rules.ui.parser.resources.common.lib.resourcesConvertor=sap.rules.ui.parser.resources.common.lib.resourcesConvertor||{};sap.rules.ui.parser.resources.common.lib.resourcesConvertor.lib=(function(){var d=sap.rules.ui.parser.resources.common.lib.oDataHandler.lib;var g=d.getOdataPropName;var a=d.getOdataPropertyValue;var b=d.getEnumPropertyValue;function c(D,p,q){var r,s,t,u;var v=a(D,d.PROPERTY_NAME_ID);if(a(D,d.PROPERTY_NAME_TYPE)===d.TYPE_CONDITION){r={colID:v,type:"condition",expression:"",alias:""};t=g(D,d.PROPERTY_NAME_CONDITION);r.expression=a(D[t],d.PROPERTY_NAME_EXPRESSION);if(r.expression==='true'){r.expression='';}u=a(D[t],d.PROPERTY_NAME_FIXED_OPERATOR);if(u){p[v]=' '+u+' ';}}else if(a(D,d.PROPERTY_NAME_TYPE)===d.TYPE_RESULT){r={colID:v,name:"",type:"output",businessDataType:""};s=g(D,d.PROPERTY_NAME_RESULT);r.businessDataType=a(D[s],d.PROPERTY_NAME_BUSINESS_DATA_TYPE);r.name=a(D[s],d.PROPERTY_NAME_DO_ATTRIBUTE_NAME);}q[v]=r.type;return r;}function e(D,p,q){var r,s,t,u,v,w=true;var x={rowID:0,row:[]};x.rowID=a(D,d.PROPERTY_NAME_ID);r=a(D,d.PROPERTY_NAME_CELLS);if(r){r.forEach(function(O){s={colID:0,content:""};s.colID=a(O,d.PROPERTY_NAME_COLUMN_ID);t=p[s.colID]||"";v=a(O,d.PROPERTY_NAME_CONTENT);u=q[s.colID];if(w&&v){w=false;}s.content=(u==='output'&&!v)?null:t+v;if(!(u==='condition'&&!v)){x.row.push(s);}});}if(w){return null;}return x;}function f(D,p){var q=null;var r=null;D.forEach(function(s){q=g(s,d.PROPERTY_NAME_USAGE);if(q&&s[q]===d.TYPE_DO){q=g(s,d.PROPERTY_NAME_ID);if(q&&s[q]===p){r=a(s,d.PROPERTY_NAME_NAME);}}});return r;}function h(D,p){var q={};q.source=a(D,d.PROPERTY_NAME_ATTRIBUTE_MAPPINGS_SOURCE);q.target=a(D,d.PROPERTY_NAME_ATTRIBUTE_MAPPINGS_TARGET);p.push(q);}function i(p,q){var r=null;var s={};s.name=a(p,d.PROPERTY_NAME_NAME);s.businessDataType=a(p,d.PROPERTY_NAME_BUSINESS_DATA_TYPE);s.dataType=a(p,d.PROPERTY_NAME_DATA_TYPE);r=g(p,d.PROPERTY_NAME_SIZE);if(r){s.size=p[r];}r=g(p,d.PROPERTY_NAME_MAPPING_INFO);if(r){s.dataMapping={};s.dataMapping.column=a(p[r],d.PROPERTY_NAME_NAME);}s.sourceType=d.SOURCE_TYPE_DATA;q.push(s);}function j(D,p,q){var r=null;var s={};s.name=a(p,d.PROPERTY_NAME_NAME);r=g(p,d.PROPERTY_NAME_TARGET_DATA_OBJECT_ID);s.target=f(D,p[r]);s.cardinality=b(p,d.PROPERTY_NAME_CARDINALITY);s.attributeMappings=[];r=g(p,d.PROPERTY_NAME_ATTRIBUTE_MAPPINGS);if(r&&p[r]&&p[r].constructor===Array){p[r].forEach(function(t){h(t,s.attributeMappings);});}q.push(s);}function k(p,q){var r={};r.name=a(p,d.PROPERTY_NAME_NAME);r.businessDataType=a(p,d.PROPERTY_NAME_BUSINESS_DATA_TYPE);r.dataType=a(p,d.PROPERTY_NAME_DATA_TYPE);r.size=a(p,d.PROPERTY_NAME_SIZE);q.push(r);}function l(D,p){var q=null;p.name=a(D,d.PROPERTY_NAME_NAME);p.type=a(D,d.PROPERTY_NAME_TYPE);q=g(D,d.PROPERTY_NAME_SCHEMA);p.schema="";if(D[q]){p.schema=D[q];}q=g(D,d.PROPERTY_NAME_PARAMETERS);if(D[q]){p.parameters=D[q];}}function m(D,p,q){var r=null;var s={};r=g(p,d.PROPERTY_NAME_USAGE);if(r){s.name=a(p,d.PROPERTY_NAME_NAME);if(p[r]===d.TYPE_DO){r=g(p,d.PROPERTY_NAME_ATTRIBUTES);if(r){s.attributes=[];var t=p[r];t.forEach(function(x){i(x,s.attributes);});}r=g(p,d.PROPERTY_NAME_ASSOCIATIONS);if(r){var u=p[r];s.associations=[];u.forEach(function(x){j(D,x,s.associations);});}r=g(p,d.PROPERTY_NAME_MAPPING_INFO);if(r){var v=p[r];s.mappingInfo={};l(v,s.mappingInfo);}q.dataObjects.push(s);}else if(p[r]===d.TYPE_RESULT){s.id=a(p,d.PROPERTY_NAME_ID);r=g(p,d.PROPERTY_NAME_ATTRIBUTES);if(r){s.inputParams=[];var w=p[r];w.forEach(function(x){k(x,s.inputParams);});}q.outputs.push(s);}}}var n=function(D){var p={"id":"","output":"","ruleBody":{"content":{"headers":[],"rows":[]},"type":"","hitPolicy":"","ruleFormat":""}};var q=g(D,d.PROPERTY_NAME_DECISION_TABLE);var r={};var s={};p.id=a(D,d.PROPERTY_NAME_ID);p.ruleBody.ruleFormat=b(D,d.PROPERTY_NAME_RULE_FORMAT);p.output=a(D,d.PROPERTY_NAME_RESULT_DO_NAME);p.ruleBody.type=b(D,d.PROPERTY_NAME_TYPE);p.ruleBody.hitPolicy=b(D[q],d.PROPERTY_NAME_HIT_POLICY);var t=a(D[q],d.PROPERTY_NAME_DT_COLUMNS);var u=a(D[q],d.PROPERTY_NAME_DDT_ROWS);if(t){var v;t.forEach(function(x){v=c(x,r,s);p.ruleBody.content.headers.push(v);});}if(u){var w;u.forEach(function(x){w=e(x,r,s);if(w){p.ruleBody.content.rows.push(w);}});}return p;};var o=function(D){var p=null;var q={"dataObjects":[],"outputs":[]};p=g(D,d.PROPERTY_NAME_DATA_OBJECTS);if(p){D[p].forEach(function(r){m(D[p],r,q);});}return q;};return{"convertRuleODataToInternalModel":n,"convertVocabularyODataToInternalModel":o};}());
