/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/core/Core","sap/ui/Device","sap/gantt/GanttChartBase","sap/ui/table/Column","sap/ui/table/TreeTable","sap/ui/core/ScrollBar","sap/ui/layout/Splitter","sap/ui/layout/SplitterLayoutData","sap/gantt/GanttChart","sap/gantt/control/Cell","sap/gantt/control/Toolbar","sap/gantt/control/AssociateContainer","sap/gantt/drawer/SelectionPanel","sap/gantt/misc/Utility","sap/gantt/misc/AxisOrdinal","sap/ui/thirdparty/d3"],function(C,D,G,a,T,S,b,c,d,e,f,A,g,U,h){"use strict";var k=G.extend("sap.gantt.GanttChartWithTable",{metadata:{properties:{cellCallback:{type:"object"},fixedColumnCount:{type:"int"}},aggregations:{customToolbarItems:{type:"sap.ui.core.Control",multiple:true,visibility:"public",singularName:"customToolbarItem",bindable:"bindable"},columns:{type:"sap.ui.table.Column",multiple:true,visibility:"public",singularName:"column"},_selectionPanel:{type:"sap.ui.table.TreeTable",multiple:false,visibility:"hidden"},_chart:{type:"sap.gantt.GanttChart",multiple:false,visibility:"hidden"}}}});k.prototype.init=function(){G.prototype.init.apply(this,arguments);jQuery.sap.measure.start("GanttChartWithTable Init","GanttPerf:GanttChartWithTable Init function");this._oGanttChart=new d();this.setAggregation("_chart",this._oGanttChart);this._oGanttChartCnt=new A({enableRootDiv:true,content:this._oGanttChart});this._oTC=this._oGanttChart._oTT;var t=this;this._oTT=new T({visibleRowCountMode:"Auto",minAutoRowCount:1,fixedColumnCount:this.getFixedColumnCount(),selectionBehavior:sap.ui.table.SelectionBehavior.Row,selectionMode:sap.ui.table.SelectionMode.Multi});this._oTT._bVariableRowHeightEnabled=true;this._oTT._collectRowHeights=function(){t._oGanttChart._setInferedBaseRowHeight(0);return t._oTC._collectRowHeights.apply(this);};this._oTT._updateTableContent=function(){sap.ui.table.TreeTable.prototype._updateTableContent.apply(this,arguments);var r=this.getRows(),R=t._oGanttChart._getRowHeights();if(!R){return;}var i=this.$().find(".sapUiTableCtrlFixed > tbody > tr");var j=this.$().find(".sapUiTableRowHdr");for(var I=0;I<r.length;I++){var l=r[I].$(),m=i.filter(":eq("+I+")"),n=j.filter(":eq("+I+")"),H=R[I]||0;var B=t._oGanttChart.getBaseRowHeight();var o=H/B>1;l.toggleClass('sapGanttExpandedRow',o);m.toggleClass('sapGanttExpandedRow',o);n.toggleClass('sapGanttExpandedRow',o);}};this._oTT.onvscroll=function(E){sap.ui.table.TreeTable.prototype.onvscroll.apply(this,arguments);t._onSelectionPanelVSbScroll();};this._oTT.attachToggleOpenState(function(E){t.fireTreeTableToggleEvent({rowIndex:E.getParameter("rowIndex"),rowContext:E.getParameter("rowContext"),expanded:E.getParameter("expanded")});});this._oTT.attachEvent("_rowsUpdated",this._onTTRowUpdate.bind(this));this.setAggregation("_selectionPanel",this._oTT);this._oToolbar=new f({type:sap.gantt.control.ToolbarType.Local,sourceId:sap.gantt.config.DEFAULT_HIERARCHY_KEY});this._oToolbar.data("holder",this);this._oToolbar.attachSourceChange(this._onToolbarSourceChange,this);this._oToolbar.attachExpandTreeChange(this._onToolbarExpandTreeChange,this);this._oToolbar.attachModeChange(this._onToolbarModeChange,this);this._oTT.addExtension(this._oToolbar);this._oSelectionPanelCnt=new A({enableRootDiv:true,content:this._oTT,layoutData:new c({size:"30%"})});this._oSplitter=new b({width:"100%",height:"100%",orientation:sap.ui.core.Orientation.Horizontal,contentAreas:[this._oSelectionPanelCnt,this._oGanttChartCnt]}).addStyleClass("sapGanttViewSplitterH");this._oSplitter.attachResize(this._onSplitterResize,this);this._oTC.addEventDelegate({onAfterRendering:this._onTCScrollafterRendering},this);this._oGanttChart.attachRowSelectionChange(this._onRowSelectionChange,this);this._oGanttChart.attachShapeSelectionChange(this._onShapeSelectionChange,this);this._oGanttChart.attachChartMouseOver(this._onChartMouseOver,this);this._oGanttChart.attachRelationshipSelectionChange(this._onRelationshipSelectionChange,this);this._oGanttChart.attachChartClick(this._onClick,this);this._oGanttChart.attachChartDoubleClick(this._onDoubleClick,this);this._oGanttChart.attachChartRightClick(this._onRightClick,this);this._oGanttChart.attachEvent("_zoomInfoUpdated",this._onZoomInfoUpdated,this);this._oGanttChart.attachEvent("_shapesUpdated",this._onShapesUpdated,this);this._oGanttChart.attachChartDragEnter(this._onChartDragEnter,this);this._oGanttChart.attachChartDragLeave(this._onChartDragLeave,this);this._oGanttChart.attachShapeDragEnd(this._onShapeDragEnd,this);this._oModesConfigMap={};this._oModesConfigMap[sap.gantt.config.DEFAULT_MODE_KEY]=sap.gantt.config.DEFAULT_MODE;this._oToolbarSchemeConfigMap={};this._oToolbarSchemeConfigMap[sap.gantt.config.DEFAULT_GANTTCHART_TOOLBAR_SCHEME_KEY]=sap.gantt.config.DEFAULT_GANTTCHART_TOOLBAR_SCHEME;this._oToolbarSchemeConfigMap[sap.gantt.config.EMPTY_TOOLBAR_SCHEME_KEY]=sap.gantt.config.EMPTY_TOOLBAR_SCHEME;this._oHierarchyConfigMap={};this._oHierarchyConfigMap[sap.gantt.config.DEFAULT_HIERARCHY_KEY]=sap.gantt.config.DEFAULT_HIERARCHY;this._oDefaultExpansionStatus={};this._oSelectionPanelDrawer=new g();this._bCanApplyTableTransform=true;this._iFirstVisiableRowIndex=undefined;this._oGanttChartSchemesConfigMap={};this._oGanttChartSchemesConfigMap[sap.gantt.config.DEFAULT_CHART_SCHEME_KEY]=sap.gantt.config.DEFAULT_CHART_SCHEME;this._oObjectTypesConfigMap={};this._oObjectTypesConfigMap[sap.gantt.config.DEFAULT_OBJECT_TYPE_KEY]=sap.gantt.config.DEFAULT_OBJECT_TYPE;this._oShapesConfigMap={};jQuery.sap.measure.end("GanttChartWithTable Init");};k.prototype.setFixedColumnCount=function(F){this.setProperty("fixedColumnCount",F);this._oTT.setFixedColumnCount(F);return this;};k.prototype.setTimeAxis=function(t){this.setProperty("timeAxis",t,true);this._oGanttChart.setTimeAxis(t);return this;};k.prototype.setMode=function(m){this.setProperty("mode",m);this._oGanttChart.setMode(m);this._oToolbar.setMode(m);return this;};k.prototype.setModes=function(m){this.setProperty("modes",m);this._oToolbar.setModes(m);this._oGanttChart.setModes(m);this._oModesConfigMap={};if(m){for(var i=0;i<m.length;i++){this._oModesConfigMap[m[i].getKey()]=m[i];}}return this;};k.prototype.setSelectionMode=function(s){this.setProperty("selectionMode",s);if(this._oTT){if(s==sap.gantt.SelectionMode.None){this._oTT.setSelectionMode(sap.ui.table.SelectionMode.None);this._oTT.setSelectionBehavior(sap.ui.table.SelectionBehavior.RowOnly);}else if(s==sap.gantt.SelectionMode.MultiWithKeyboard){this._oTT.setSelectionMode(sap.ui.table.SelectionMode.Multi);this._oTT.setSelectionBehavior(sap.ui.table.SelectionBehavior.Row);}else{if(s==sap.gantt.SelectionMode.Single){this._oTT.setSelectionMode(sap.ui.table.SelectionMode.Single);}else{this._oTT.setSelectionMode(sap.ui.table.SelectionMode.MultiToggle);}this._oTT.setSelectionBehavior(sap.ui.table.SelectionBehavior.Row);}}if(this._oGanttChart){this._oGanttChart.setSelectionMode(s);}return this;};k.prototype.setToolbarSchemes=function(t){this.setProperty("toolbarSchemes",t);this._oToolbar.setToolbarSchemes(t);this._oToolbarSchemeConfigMap={};if(t){for(var i=0;i<t.length;i++){this._oToolbarSchemeConfigMap[t[i].getKey()]=t[i];}}return this;};k.prototype.setHierarchyKey=function(H){this.setProperty("hierarchyKey",H);this._oGanttChart.setProperty("hierarchyKey",H);this._oToolbar.setSourceId(H);this._hierarchyChange();return this;};k.prototype.setHierarchies=function(H){this.setProperty("hierarchies",H);this._oToolbar.setHierarchies(H);this._oGanttChart.setHierarchies(H);this._oHierarchyConfigMap={};if(H){for(var i=0;i<H.length;i++){this._oHierarchyConfigMap[H[i].getKey()]=H[i];}}this._hierarchyChange();return this;};k.prototype.setCalendarDef=function(o){this.setAggregation("calendarDef",o);var p=o.getBindingInfo("defs");if(p){p.templateShareable=true;}this._oGanttChart.setCalendarDef(o.clone());return this;};k.prototype._hierarchyChange=function(){var H=this.getHierarchyKey();if(H&&this._oHierarchyConfigMap[H]){if(this._oHierarchyConfigMap[H].getColumns()&&this._oHierarchyConfigMap[H].getColumns().length>0){this._buildColumnFromCellCallback();}var m=this.getMode();if(m===sap.gantt.config.DEFAULT_MODE_KEY&&this._oHierarchyConfigMap[this.getHierarchyKey()]){m=this._oHierarchyConfigMap[this.getHierarchyKey()].getActiveModeKey();}this.setMode(m);}};k.prototype._buildColumnFromCellCallback=function(){this._oTT.removeAllColumns();var H,j;H=this._oHierarchyConfigMap[this.getHierarchyKey()];if(H){j=H.getColumns();}if(j){for(var i=0;i<j.length;i++){var o=new a({label:j[i].getTitle(),sortProperty:j[i].getSortAttribute(),filterProperty:j[i].getFilterAttribute(),width:j[i].getWidth(),template:new e({cellCallback:this.getCellCallback(),columnConfig:j[i]})});this._oTT.addColumn(o);}}};k.prototype.setObjectTypes=function(o){this.setProperty("objectTypes",o,true);this._oGanttChart.setObjectTypes(o);this._oObjectTypesConfigMap={};if(o){for(var i=0;i<o.length;i++){this._oObjectTypesConfigMap[o[i].getKey()]=o[i];}}return this;};k.prototype.setChartSchemes=function(j){this.setProperty("chartSchemes",j,true);this._oGanttChart.setChartSchemes(j);this._oGanttChartSchemesConfigMap={};if(j){for(var i=0;i<j.length;i++){this._oGanttChartSchemesConfigMap[j[i].getKey()]=j[i];}}return this;};k.prototype.setShapeDataNames=function(s){this.setProperty("shapeDataNames",s);this._oGanttChart.setShapeDataNames(s);return this;};k.prototype.setLocale=function(l){this.setProperty("locale",l,true);this._oGanttChart.setLocale(l);return this;};k.prototype.setShapes=function(s){this.setProperty("shapes",s,true);this._oGanttChart.setShapes(s);this._oShapesConfigMap={};if(s){for(var i=0;i<s.length;i++){this._oShapesConfigMap[s[i].getKey()]=s[i];}}return this;};k.prototype.setSvgDefs=function(s){this.setProperty("svgDefs",s);this._oGanttChart.setSvgDefs(s);return this;};k.prototype.setEnableCursorLine=function(E){this.setProperty("enableCursorLine",E);this._oGanttChart.setEnableCursorLine(E);this._oToolbar.setEnableCursorLine(E);return this;};k.prototype.setEnableNowLine=function(E){this.setProperty("enableNowLine",E);this._oGanttChart.setEnableNowLine(E);this._oToolbar.setEnableNowLine(E);return this;};k.prototype.setEnableVerticalLine=function(E){this.setProperty("enableVerticalLine",E);this._oGanttChart.setEnableVerticalLine(E);this._oToolbar.setEnableVerticalLine(E);return this;};k.prototype.setTimeZoomRate=function(t){this.setProperty("timeZoomRate",t,true);this._oGanttChart.setTimeZoomRate(t);return this;};k.prototype.addRelationship=function(r){this._oGanttChart.addRelationship(r);};k.prototype.insertRelationship=function(i,r){this._oGanttChart.insertRelationship(i,r);};k.prototype.removeRelationship=function(r){this._oGanttChart.removeRelationship(r);};k.prototype.getRelationships=function(){this._oGanttChart.getRelationships();};k.prototype.destroyRelationships=function(){this._oGanttChart.destroyRelationships();};k.prototype.indexOfRelationship=function(r){this._oGanttChart.indexOfRelationship(r);};k.prototype.removeAllRelationships=function(){this._oGanttChart.removeAllRelationships();};k.prototype.updateRelationships=function(r){this._oGanttChart.updateRelationships(r);};k.prototype.setSelectionPanelSize=function(s,i){this.setProperty("selectionPanelSize",s,i);this._oSelectionPanelCnt.setLayoutData(new c({size:s}));return this;};k.prototype.updateTableSize=function(){if(this._oTT._updateTableSizes){this._oTT._updateTableSizes();}if(this._oTC._updateTableSizes){this._oTC._updateTableSizes();}};k.prototype.addCustomToolbarItem=function(o){this._oToolbar.addCustomToolbarItem(o);};k.prototype.insertCustomToolbarItem=function(o,i){this._oToolbar.insertCustomToolbarItem(o,i);};k.prototype.removeCustomToolbarItem=function(o){this._oToolbar.removeCustomToolbarItem(o);};k.prototype.removeAllCustomToolbarItems=function(){this._oToolbar.removeAllCustomToolbarItems();};k.prototype.addColumn=function(o){this._oTT.addColumn(o);};k.prototype.insertColumn=function(o,i){this._oTT.insertColumn(o,i);};k.prototype.removeColumn=function(o){this._oTT.removeColumn(o);};k.prototype.removeAllColumns=function(){this._oTT.removeAllColumns();};k.prototype.getColumns=function(){return this._oTT.getColumns();};k.prototype._bindAggregation=function(n,B){var m,o;if(n=="rows"&&B){m=this.getModel(B.model);o=this.getBindingContext(B.model);if(o&&m){B.path=m.resolve(B.path,o);}this._oTT.bindRows(B);this._oGanttChart.bindRows(B);this._oTC.updateRows=this._updateRows.bind(this);}else if(n=="relationships"&&B){m=this.getModel(B.model);o=this.getBindingContext(B.model);if(o&&m){B.path=m.resolve(B.path,o);}this._oGanttChart.bindRelationships(B);}else if(n=="columns"&&B){m=this.getModel(B.model);o=this.getBindingContext(B.model);if(o&&m){B.path=m.resolve(B.path,o);}this._oTT.bindColumns(B);}else{return sap.ui.core.Control.prototype._bindAggregation.apply(this,arguments);}};k.prototype._updateRows=function(r){if(this._oTC.getFirstVisibleRow()===this._oTT.getFirstVisibleRow()||r===sap.ui.model.ChangeReason.Filter||r===sap.ui.model.ChangeReason.Sort){sap.ui.table.Table.prototype.updateRows.apply(this._oTT,arguments);}sap.ui.table.Table.prototype.updateRows.apply(this._oTC,arguments);};k.prototype._detachToolbarEvents=function(){this._oToolbar.detachSourceChange(this._onToolbarSourceChange,this);this._oToolbar.detachExpandTreeChange(this._onToolbarExpandTreeChange,this);};k.prototype.onAfterRendering=function(){this._expandDefaultLevel();this._attachEvents();};k.prototype._adjustChartHeaderHeight=function(){var i=this._oTT.$().find(".sapUiTableExt");var j=this._oTT.$().find(".sapUiTableColHdrCnt");var l;if(i.height()===null){l=i.outerHeight()+j.height();}else{l=i.outerHeight()+j.height()+1;}var m=this._oGanttChart.$().find(".sapGanttChartHeader");m.height(l);m.css("min-height",l);var n=this._oGanttChart.$().find(".sapGanttChartHeaderSvg");n.height(l);n.css("min-height",l);};k.prototype.onBeforeRendering=function(){if(this._oToolbar.getAllToolbarItems().length===0){this._oTT.removeExtension(this._oToolbar);}else if(this._oTT.getExtension().length==0){this._oTT.addExtension(this._oToolbar);}};k.prototype._attachEvents=function(){var o={onAfterRendering:this._syncGanttTablesDomEvents};this._oTT.removeEventDelegate(o);this._oTT.addEventDelegate(o,this);this._oTC.removeEventDelegate(o);this._oTC.addEventDelegate(o,this);this._appendMaskSvg();var i=this.$().find("#"+this.getId()+"-spm-svg-table");if(D.browser.firefox){i.unbind("MozMousePixelScroll.sapUiTableMouseWheel",this._onMouseWheel.bind(this));i.bind("MozMousePixelScroll.sapUiTableMouseWheel",this._onMouseWheel.bind(this));}else{i.unbind("wheel.sapUiTableMouseWheel",this._onMouseWheel.bind(this));i.bind("wheel.sapUiTableMouseWheel",this._onMouseWheel.bind(this));}};k.prototype._onMouseWheel=function(E){var o=E.originalEvent;var i=o.shiftKey;var s=0;if(D.browser.firefox){s=o.detail;}else{if(i){s=o.deltaX;}else{s=o.deltaY;}}if(i){var H=this._oTT.getDomRef(sap.ui.table.SharedDomRef.HorizontalScrollBar);if(H){H.scrollLeft=H.scrollLeft+s;}}else{var v=this._oTT.getDomRef(sap.ui.table.SharedDomRef.VerticalScrollBar);if(v){v.scrollTop=v.scrollTop+s;}}E.preventDefault();E.stopPropagation();};k.prototype._onRowSelectionChange=function(E){this.fireRowSelectionChange({originEvent:E.getParameter("originEvent")});this._oTT._oSelection.fireSelectionChanged();};k.prototype._onChartMouseOver=function(E){var p=E.getParameters();this.fireChartMouseOver({objectInfo:p.objectInfo,leadingRowInfo:p.leadingRowInfo,timestamp:p.timestamp,svgId:p.svgId,svgCoordinate:p.svgCoordinate,effectingMode:p.effectingMode,originEvent:p.originEvent});};k.prototype._onShapeSelectionChange=function(E){this.fireShapeSelectionChange({originEvent:E.getParameter("originEvent")});};k.prototype._onRelationshipSelectionChange=function(E){this.fireRelationshipSelectionChange({originEvent:E.getParameter("originEvent")});};k.prototype._onClick=function(E){var p=E.getParameters();this.fireChartClick({objectInfo:p.objectInfo,leadingRowInfo:p.leadingRowInfo,timestamp:p.timestamp,svgId:p.svgId,svgCoordinate:p.svgCoordinate,effectingMode:p.effectingMode,originEvent:p.originEvent});};k.prototype._onDoubleClick=function(E){var p=E.getParameters();this.fireChartDoubleClick({objectInfo:p.objectInfo,leadingRowInfo:p.leadingRowInfo,timestamp:p.timestamp,svgId:p.svgId,svgCoordinate:p.svgCoordinate,effectingMode:p.effectingMode,originEvent:p.originEvent});};k.prototype._onRightClick=function(E){var p=E.getParameters();this.fireChartRightClick({objectInfo:p.objectInfo,leadingRowInfo:p.leadingRowInfo,timestamp:p.timestamp,svgId:p.svgId,svgCoordinate:p.svgCoordinate,effectingMode:p.effectingMode,originEvent:p.originEvent});};k.prototype._onChartDragEnter=function(E){this.fireChartDragEnter({originEvent:E.getParameter("originEvent")});};k.prototype._onChartDragLeave=function(E){this.fireChartDragLeave({originEvent:E.getParameter("originEvent"),draggingSource:E.getParameter("draggingSource")});};k.prototype._onShapeDragEnd=function(E){var p=E.getParameters();this.fireShapeDragEnd({originEvent:p.originEvent,sourceShapeData:p.sourceShapeData,targetData:p.targetData,sourceSvgId:p.sourceSvgId,targetSvgId:p.targetSvgId});};k.prototype._onChartHSbScroll=function(E){if(this._scrollFlag){delete this._scrollFlag;return;}var n=(C.getConfiguration().getRTL()&&sap.ui.Device.browser.name==="ff")?this._oTC.$(sap.ui.table.SharedDomRef.HorizontalScrollBar).scrollLeftRTL():this._oTC.$(sap.ui.table.SharedDomRef.HorizontalScrollBar).scrollLeft();this.fireHorizontalScroll({scrollSteps:n,leftOffsetRate:this._oGanttChart.updateLeftOffsetRate(n)});};k.prototype._onChartVSbScroll=function(E){var i=jQuery(this._oTT.getDomRef(sap.ui.table.SharedDomRef.VerticalScrollBar));var j=jQuery(this._oTC.getDomRef(sap.ui.table.SharedDomRef.VerticalScrollBar));if(this.sScrollSource===null||this.sScrollSource!=="GanttChartWithTable"){this.sScrollSource="GanttChart";i.scrollTop(j.scrollTop());}else{this.sScrollSource=null;}this.fireVerticalScroll({scrollSteps:this._oTC.getFirstVisibleRow(),scrollPosition:jQuery(this._oTC.getDomRef(sap.ui.table.SharedDomRef.VerticalScrollBar)).scrollTop()});};k.prototype._drawSvg=function(){this._appendMaskSvg();this._updateMaskSvg();this._updateTableRowHeights();this._drawSelectionPanel();};k.prototype._onZoomInfoUpdated=function(E){this.fireEvent("_zoomInfoUpdated",{zoomInfo:E.getParameter("zoomInfo")});};k.prototype._onShapesUpdated=function(E){this.fireEvent("_shapesUpdated",{aSvg:E.getParameter("aSvg")});};k.prototype._onSelectionPanelVSbScroll=function(){var i=jQuery(this._oTT.getDomRef(sap.ui.table.SharedDomRef.VerticalScrollBar));var j=jQuery(this._oTC.getDomRef(sap.ui.table.SharedDomRef.VerticalScrollBar));if(this.sScrollSource===null||this.sScrollSource!=="GanttChart"){this.sScrollSource="GanttChartWithTable";j.scrollTop(i.scrollTop());}else{this.sScrollSource=null;}this._applyTransform();};k.prototype._applyTransform=function(){this.$().find("#"+this.getId()+"-spm-svg-table").css("transform",this._oTT.$().find(".sapUiTableCtrlRowScroll").css("transform"));};k.prototype._onSplitterResize=function(E){this._oTC.updateRows();var p=E.getParameters();this.fireSplitterResize(p);};k.prototype._onToolbarSourceChange=function(E){var o=this.getHierarchyKey();this.setHierarchyKey(E.getParameter("id"));this.notifySourceChange();this.fireGanttChartSwitchRequested({hierarchyKey:E.getParameter("id"),oldHierarchyKey:o});};k.prototype._onToolbarExpandTreeChange=function(E){var s=E.getParameter("action");if(s){var j=this._oTT.getSelectedIndices();for(var i=j.length-1;i>-1;i--){this._oTT[s](j[i]);j=this._oTT.getSelectedIndices();}}};k.prototype._onToolbarModeChange=function(E){var B=this.getBinding("mode");if(B){B.setValue(E.getParameter("mode"));}this.setMode(E.getParameter("mode"));};k.prototype.handleExpandChartChange=function(E,i,s){s=s?s:this._oTT.getSelectedIndices();this._oGanttChart.handleExpandChartChange(E,i,s);};k.prototype.invertRowExpandStatus=function(s,i){if(s&&s.length>0&&i){this._oGanttChart.invertRowExpandStatus(s,i);}};k.prototype._updateTableRowHeights=function(){var t=this._oTT;var H=this._oGanttChart._getRowHeights();if(!H){return;}t._updateRowHeader(H);};k.prototype.setBaseRowHeight=function(n){this.setProperty("baseRowHeight",n);this._oTT.setRowHeight(n);return this._oGanttChart.setBaseRowHeight(n);};k.prototype.getBaseRowHeight=function(){return this._oGanttChart.getBaseRowHeight();};k.prototype._onTTRowUpdate=function(){if(this._oGanttChart.isRowExpanded()){var i=this._oTT.$();var j=this.$().find("#"+this.getId()+"-spm-svg-table-ctn");j.height(i.find(".sapUiTableCCnt").height());j.show();var l=j.find(".sapGanttSPMaskSvg");l.height(i.find(".sapUiTableCtrlCnt").height());this._drawSvg();}else{var j=this.$().find("#"+this.getId()+"-spm-svg-table-ctn");j.hide();}this._oTT._updateTableContent();this._adjustChartHeaderHeight();this._adjustGanttInferredRowHeight();};k.prototype._adjustGanttInferredRowHeight=function(){var H=T.prototype._collectRowHeights.apply(this._oTT);var F=this.getFirstVisibleRow();var s=this._oGanttChart._getDrawingData([F,F]);if(H&&H.length>0&&s&&s.length>0){var B=H[0]/s[0].visibleRowSpan;this._oGanttChart._setInferedBaseRowHeight(B);}};k.prototype._onTCScrollafterRendering=function(E){var i=jQuery(this._oTC.getDomRef(sap.ui.table.SharedDomRef.HorizontalScrollBar));i.unbind("scroll.sapUiTableHScroll");i.unbind("scroll.sapUiTableHScrollForGanttChartWithTable",this._onChartHSbScroll);i.bind("scroll.sapUiTableHScrollForGanttChartWithTable",jQuery.proxy(this._onChartHSbScroll,this));var j=jQuery(this._oTC.getDomRef(sap.ui.table.SharedDomRef.VerticalScrollBar));j.unbind("scroll.sapUiTableTCVScrollForGanttChartWithTable",this._onChartVSbScroll);j.bind("scroll.sapUiTableTCVScrollForGanttChartWithTable",jQuery.proxy(this._onChartVSbScroll,this));};k.prototype._syncGanttTablesDomEvents=function(E){var s=E.srcControl,t=s.getId()===this._oTT.getId()?this._oTC:this._oTT;s.$().find(".sapUiTableRowHdr, .sapUiTableTr").hover(function(E){var i=jQuery(E.currentTarget).data("sapUiRowindex");t.$().find(".sapUiTableCtrlFixed > tbody > tr").filter(":eq("+i+")").addClass("sapUiTableRowHvr");t.$().find(".sapUiTableCtrlScroll > tbody > tr").filter(":eq("+i+")").addClass("sapUiTableRowHvr");t.$().find(".sapUiTableRowHdr").filter(":eq("+i+")").addClass("sapUiTableRowHvr");},function(E){t.$().find(".sapUiTableCtrlFixed > tbody > tr").removeClass("sapUiTableRowHvr");t.$().find(".sapUiTableCtrlScroll > tbody > tr").removeClass("sapUiTableRowHvr");t.$().find(".sapUiTableRowHdr").removeClass("sapUiTableRowHvr");});};k.prototype._setLargeDataScrolling=function(l){if(this._oTT._setLargeDataScrolling){this._oTT._setLargeDataScrolling(!!l);}if(this._oTC._setLargeDataScrolling){this._oTC._setLargeDataScrolling(!!l);}};k.prototype.getToolbarSchemeKey=function(){return this._oToolbar.getToolbarSchemeKey();};k.prototype.jumpToPosition=function(o){this._scrollFlag=true;this._oGanttChart.jumpToPosition(o);};k.prototype.selectShapes=function(i,j){return this._oGanttChart.selectShapes(i,j);};k.prototype.deselectShapes=function(i){return this._oGanttChart.deselectShapes(i);};k.prototype.selectRelationships=function(i,j){return this._oGanttChart.selectRelationships(i,j);};k.prototype.deselectRelationships=function(i){return this._oGanttChart.deselectRelationships(i);};k.prototype.selectRows=function(i,j){return this._oGanttChart.selectRows(i,j);};k.prototype.deselectRows=function(i){return this._oGanttChart.deselectRows(i);};k.prototype.selectRowsAndShapes=function(i,I){return this._oGanttChart.selectRowsAndShapes(i,I);};k.prototype.getAllSelections=function(){return this._oGanttChart.getAllSelections();};k.prototype.getSelectedShapes=function(){var s=this._oGanttChart.getSelectedShapes();return s;};k.prototype.getSelectedRows=function(){var s=this._oGanttChart.getSelectedRows();return s;};k.prototype.getSelectedRelationships=function(){var s=this._oGanttChart.getSelectedRelationships();return s;};k.prototype.setDraggingData=function(o){this._oGanttChart.setDraggingData(o);};k.prototype.getRowByShapeUid=function(s){return this._oGanttChart.getRowByShapeUid(s);};k.prototype._drawSelectionPanel=function(){var t=d3.select("#"+this.getId()+"-spm-svg-table");var i=this._oTT.$().find(".sapUiTableRowHdrScr").width();var v=this._getVisibleRowData();if(v!==undefined){this._oSelectionPanelDrawer.drawSvg(t,v,i,this);this.$().find("#"+this.getId()+"-spm-svg-table").css("transform",this._oTT.$().find(".sapUiTableCtrlRowScroll").css("transform"));this._iFirstVisiableRowIndex=this._oTT.getFirstVisibleRow();this._bCanApplyTableTransform=true;}};k.prototype._getVisibleRowData=function(){var F=this._oTT.getFirstVisibleRow();var v=this._oTT.getVisibleRowCount();var V=this._oGanttChart._getDrawingData([F,F+v-1]);var B=this._oGanttChart.getBaseRowHeight();var p=0;for(var i=0;i<V.length;i++){var s=V[i];s.rowHeight=s.rowSpan*B;s.y=p;p+=s.rowHeight;}return V;};k.prototype._appendMaskSvg=function(){var i=this.$().find("#"+this.getId()+"-spm-svg-table-ctn");var j=this._oTT.$();if(i.length==0){i=$("<div id='"+this.getId()+"-spm-svg-table-ctn' class='sapGanttChartSPMSvgCtn' >"+"<svg id='"+this.getId()+"-spm-svg-table' class='sapGanttSPMaskSvg'>"+"</svg>"+"</div>");j.parent().append(i);}};k.prototype._updateMaskSvg=function(){var i=this.$().find("#"+this.getId()+"-spm-svg-table-ctn");var j=this._oTT.$();i.height(j.find(".sapUiTableCCnt").height());i.width($(document).width());i.css("top",this._oGanttChart.$().find(".sapGanttChartHeader").height()+1);i.css("min-width",j.find("table").css("min-width"));var l=i.find(".sapGanttSPMaskSvg");l.width(i.width());l.height(j.find(".sapUiTableCtrlCnt").height());};k.prototype.getAxisOrdinal=function(){return this._oGanttChart.getAxisOrdinal();};k.prototype.getAxisTime=function(){return this._oGanttChart.getAxisTime();};k.prototype.getZoomInfo=function(){return this._oGanttChart.getZoomInfo();};k.prototype._expandDefaultLevel=function(){var E;var H=this.getHierarchyKey();if(this._oDefaultExpansionStatus){if(this._oDefaultExpansionStatus[H]===true){return;}}if(this._oHierarchyConfigMap[H]&&this._oHierarchyConfigMap[H].getExpandedLevels()){E=this._oHierarchyConfigMap[this.getHierarchyKey()].getExpandedLevels();var B=this._oTT.getBinding("rows");if(!B){return;}var t=B.getModel().getObject(B.getPath());var l=0;var r=0;var m=[];var n=this._oTT.getBindingInfo("rows").parameters.arrayNames;var o=function(N){for(var i=0;i<n.length;i++){if(N[n[i]]){return true;}}return false;};if(E.length<=0){this._oDefaultExpansionStatus[H]=true;return;}else{var p=function(i,N){if(l>E.length){if(l===(E.length+1)){r++;}return;}if(o(N)===true){if(!($.inArray(N.type,E[l])>-1)){if(m){m.push(r);}else{m=[r];}}r++;if(l<=E.length){l++;for(var j=0;j<n.length;j++){if(N[n[j]]){jQuery.each(N[n[j]],p);}}l--;}}else{r++;}};var q=function(){B.detachChange(q,this);for(var i=0;i<n.length;i++){if(t[n[i]]){jQuery.each(t[n[i]],p);}}B.getContexts(this._oTT.getFirstVisibleRow(),0);for(var I=m.length-1;I>=0;I--){if(B.getNodeByIndex(m[I])){this._oTT.collapse(m[I]);}}};B.attachChange(q,this);this._oTT.expandToLevel(E.length);}}this._oDefaultExpansionStatus[H]=true;};k.prototype.expandToLevel=function(l){this._oTT.expandToLevel(l);return this;};k.prototype.expand=function(r){this._oTT.expand(r);return this;};k.prototype.collapse=function(r){this._oTT.collapse(r);return this;};k.prototype.setSelectedIndex=function(r){this._oTT.setSelectedIndex(r);return this;};k.prototype.getSelectedIndex=function(){return this._oTT.getSelectedIndex();};k.prototype.getFirstVisibleRow=function(){return this._oTT.getFirstVisibleRow();};k.prototype.setFirstVisibleRow=function(r){this._oTT.setFirstVisibleRow(r);return this;};k.prototype.getVisibleRowCount=function(){return this._oTT.getVisibleRowCount();};k.prototype.getRows=function(){return this._oTT.getRows();};k.prototype.exit=function(){this._detachToolbarEvents();this._oSplitter.destroy();};k.prototype.notifySourceChange=function(){this._oTT.setFirstVisibleRow(0);this._oGanttChart.notifySourceChange();};k.prototype.autoResizeColumn=function(j){if(j>=0&&jQuery.isNumeric(j)){this._oTT.autoResizeColumn(j);}else{for(var i=this._oTT.getColumns().length;i>=0;i--){this._oTT.autoResizeColumn(i);}}};k.prototype._autoResizeColumn=function(){if(this._oHierarchyConfigMap[this.getHierarchyKey()].getAutoResizeColumn()){this.autoResizeColumn();}};return k;},true);
