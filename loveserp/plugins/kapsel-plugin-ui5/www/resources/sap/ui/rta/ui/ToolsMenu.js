/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
sap.ui.define(['sap/ui/rta/library','sap/ui/core/Control','sap/m/Toolbar','sap/m/ToolbarLayoutData','sap/m/ToolbarSpacer','sap/m/Label','sap/ui/core/Popup','sap/ui/fl/registry/Settings','sap/ui/fl/Utils'],function(l,C,T,a,b,L,P,F,U){"use strict";var c=C.extend("sap.ui.rta.ui.ToolsMenu",{metadata:{library:"sap.ui.rta",aggregations:{"toolbars":{type:"sap.m.Toolbar",multiple:true,singularName:"toolbar"}},events:{"undo":{},"redo":{},"close":{},"toolbarClose":{},"restore":{},"transport":{}}}});c.prototype.init=function(){this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.rta");};c.prototype.createToolbar=function(){var t=null;var z=P.getNextZIndex();if(!this._oToolBar){var A=null;var o=null;var B=null;var s=null;var d=null;t=" - "+this._oRb.getText("TOOLBAR_TITLE");A=new L({text:t,layoutData:new a({shrinkable:false})});A.bAllowTextSelection=false;t=null;o=new L({text:t,layoutData:new a({shrinkable:false})});o.bAllowTextSelection=false;t=this._oRb.getText("BTN_UNDO");this._oButtonUndo=new sap.m.Button({type:"Transparent",icon:"sap-icon://undo",enabled:false,tooltip:t,layoutData:new a({shrinkable:false})});this._oButtonUndo.data("Action","UNDO",true);this._oButtonUndo.attachEvent('press',this._onUndo,this);t=this._oRb.getText("BTN_REDO");this._oButtonRedo=new sap.m.Button({type:"Transparent",icon:"sap-icon://redo",iconFirst:false,enabled:false,tooltip:t,layoutData:new a({shrinkable:false})});this._oButtonRedo.data("Action","REDO",true);this._oButtonRedo.attachEvent('press',this._onRedo,this);t=this._oRb.getText("BTN_RESTORE");this._oButtonRestore=new sap.m.Button({type:"Transparent",text:t,visible:true,tooltip:t,layoutData:new a({shrinkable:false})});this._oButtonRestore.data("Action","RESTORE",true);this._oButtonRestore.attachEvent('press',this._onRestore,this);t=this._oRb.getText("BTN_EXIT");B=new sap.m.Button({type:"Transparent",text:t,tooltip:t,layoutData:new a({shrinkable:false})});B.data("Action","EXIT",true);B.attachEvent('press',this.close,this);t=this._oRb.getText("BTN_TRANSPORT");this._oButtonTransport=new sap.m.Button({type:"Transparent",text:t,visible:false,tooltip:t,layoutData:new a({shrinkable:false})});this._oButtonTransport.data("Action","TRANSPORT",true);this._oButtonTransport.attachEvent('press',this._onTransport,this);s=new b();this._oToolBar=new T({active:true,content:[o,A,s,this._oButtonUndo,this._oButtonRedo,this._oButtonRestore,this._oButtonTransport,B]});this._oToolBar.addStyleClass("sapUiRTAToolBar");this.addToolbar(this._oToolBar);jQuery("body").prepend('<div id="RTA-Toolbar" style="z-index: '+z+'"></div>');d=jQuery("#RTA-Toolbar").addClass("sapUiRTAToolsMenuWrapper");d=d[0];this.placeAt(d);}};c.prototype.exit=function(){jQuery("#RTA-Toolbar").remove();};c.prototype._onTransport=function(){this.fireTransport();};c.prototype._checkTransportAvailable=function(){var t=this;return F.getInstance(U.getComponentClassName(this._oRootControl)).then(function(s){if(!s.isProductiveSystem()&&!s.hasMergeErrorOccured()){var i=s.isAtoEnabled();t._oButtonTransport.setVisible(true);t.adaptTransportText(i);return i;}}).catch(function(){t._oButtonTransport.setVisible(false);});};c.prototype.show=function(){this._oToolBar.addStyleClass("sapUiRTAToolBarVisible");this._oToolBar.removeStyleClass("sapUiRTAToolBarInvisible");};c.prototype.hide=function(){var t=this;this._oToolBar.addStyleClass("sapUiRTAToolBarInvisible");var o=document.getElementsByClassName("sapUiRTAToolBar")[0];var A=function(){t.fireClose();};o.addEventListener("webkitAnimationEnd",A);o.addEventListener("animationend",A);o.addEventListener("oanimationend",A);};c.prototype._onUndo=function(){this.fireUndo();};c.prototype._onRedo=function(){this.fireRedo();};c.prototype._onRestore=function(){this.fireRestore();};c.prototype.close=function(){this.fireToolbarClose();};c.prototype.setTitle=function(t){var o=this._oToolBar.getContent()[0];o.setText(t);};c.prototype.setRootControl=function(o){this._oRootControl=o;};c.prototype.adaptTransportText=function(A){var t=null;if(A){t=this._oRb.getText("BTN_PUBLISH");}else{t=this._oRb.getText("BTN_TRANSPORT");}this._oButtonTransport.setText(t);this._oButtonTransport.setTooltip(t);};c.prototype.adaptUndoRedoEnablement=function(d,e){this._oButtonUndo.setEnabled(d);this._oButtonRedo.setEnabled(e);};return c;},true);
