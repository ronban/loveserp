/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
sap.ui.define(['sap/ui/base/ManagedObject','sap/ui/rta/controlAnalyzer/ControlAnalyzerFactory','sap/ui/fl/registry/ChangeRegistry'],function(M,C,a){"use strict";var g=function(s,h){var r=a.getInstance().getRegistryItems({controlType:s,changeTypeName:h});if(r&&r[s]&&r[s][h]){var R=r[s][h];return R.getChangeTypeMetadata().getChangeHandler();}else{jQuery.sap.log.warning("No '"+h+"' change handler for "+s+" registered");}};var c=function(E,o,s){var h=o.getName();var A=C.getControlAnalyzerFor(E);if(A.mapSettings){s=A.mapSettings(h,E,s);}var i=A.getConfiguredElement(E);var j=i.getMetadata().getName();var k=A.getFlexChangeType(h,E,s);if(k){var l=g(j,k);if(l){o.setChangeHandler(l);o.setChangeType(k);if(E!==i&&o.setOriginalElement){var S=A._getStableElementForCommand(E);o.setOriginalElement(S);}}}else{jQuery.sap.log.warning("No "+h+" change type registered for "+j);}return true;};var f=function(E,o,s,h){var S=s.source.publicAggregation;var A=h.createAggregationDesignTimeMetadata(S);var i=s.movedElements[0].element||sap.ui.getCore().byId(s.movedElements[0].id);var j=A.getMoveAction(i);A.destroy();if(!j){return false;}var k=E.getMetadata().getName();var l=g(k,j);if(!l){return false;}o.setChangeHandler(l);o.setChangeType(j);return true;};var b=function(E,o,s,D){var h=D.changeType;if(!h){return false;}var i=E.getMetadata().getName();var j=g(i,h);if(!j){return false;}o.setChangeHandler(j);o.setChangeType(h);o.setDesignTimeMetadata(D);return true;};var d=function(E,o,s,D){var r=s.removedElement||sap.ui.getCore().byId(s.removedElement.id);var A=D.getAction("remove",r);var h=A&&A.changeType;if(!h){return false;}var i=E.getMetadata().getName();var j=g(i,h);if(!j){return false;}o.setRemoveMetadata(A);o.setChangeHandler(j);o.setChangeType(h);return true;};var F=function(E,s){var A=C.getControlAnalyzerFor(E);return A.getCommandClass(s);};var G=function(E){var A=C.getControlAnalyzerFor(E);return A.getConfiguredElement(E);};var m={"Hide":{findClass:F,configure:c},"Unhide":{findClass:F,configure:c},"Stash":{clazz:'sap.ui.rta.command.Stash'},"Unstash":{clazz:'sap.ui.rta.command.Unstash'},"Ungroup":{clazz:'sap.ui.rta.command.Ungroup'},"Group":{clazz:'sap.ui.rta.command.Group'},"Move":{clazz:'sap.ui.rta.command.Move',configure:f},"Remove":{clazz:'sap.ui.rta.command.Remove',configure:d},"Add":{findClass:F,configure:c},"Composite":{clazz:'sap.ui.rta.command.CompositeCommand'},"Rename":{clazz:'sap.ui.rta.command.Rename',configure:b},"Property":{clazz:'sap.ui.rta.command.Property'},"BindProperty":{clazz:'sap.ui.rta.command.BindProperty'}};var e=M.extend("sap.ui.rta.command.CommandFactory",{metadata:{library:"sap.ui.rta",properties:{},associations:{},events:{}}});e.getCommandFor=function(E,s,S,D){var h=m[s];var i;if(h.findClass){i=h.findClass(E,s);}else{i=h.clazz;}jQuery.sap.require(i);var j=jQuery.sap.getObject(i);var o=G(E);S=jQuery.extend(S,{element:o,name:s});var k=new j(S);var l=true;if(h.configure){l=h.configure(E,k,S,D);}if(l){k.prepareActionData();return k;}else{k.destroy();}};return e;},true);
