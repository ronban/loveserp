/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
sap.ui.define(['sap/ui/rta/command/FlexCommand','sap/ui/rta/command/Hide',"sap/ui/fl/changeHandler/HideControl"],function(F,H,a){"use strict";var b=H.extend("sap.ui.rta.command.HideForm",{metadata:{library:"sap.ui.rta",properties:{originalElement:{type:"object"},changeType:{type:"string",defaultValue:"hideControl"},groupId:{type:"string"},groupIndex:{type:"integer"},nextGroupIndex:{type:"integer",defaultValue:-1},fields:{type:"array"}},associations:{},events:{}}});b.FORWARD=true;b.BACKWARD=false;b.prototype.init=function(){};b.prototype._getSpecificChangeInfo=function(f){var e=this.getElement();var o=this.getOriginalElement();var s={};s.selector={};s.selector.id=e.getId();s.changeType=this.getChangeType();s.removedElement={id:o.getId()};if(o instanceof sap.ui.core.Title){this._setGroupInfo(o);}return s;};b.prototype._setGroupInfo=function(t){var c=this;var C=this.getElement().getContent();var f=[];C.some(function(o,i){if(o===t){c.setGroupId(t.getId());c.setGroupIndex(i);}if(c.getGroupIndex()<i){if(o instanceof sap.ui.core.Title){c.setNextGroupIndex(i);return true;}else{if(o.getVisible()===true){f.push(o);}}}});this.setFields(f);};b.prototype._getFlexChange=function(f,e){var s=this._getSpecificChangeInfo(f);var c=this._completeChangeContent(s);return{change:c,selectorElement:e};};b.prototype._getForwardActionData=function(e){return this._getFlexChange(b.FORWARD,e);};b.prototype._getBackwardActionData=function(e){return this._getFlexChange(b.BACKWARD,e);};b.prototype._undoWithElement=function(e){var c=this.getOriginalElement();var C=e.getContent();var s=-1;if(this.getChangeType()==="hideSimpleFormField"){C.some(function(f,i){if(f===c){s=i;f.setVisible(true);}if(s>=0&&i>s){if((f instanceof sap.m.Label)||(f instanceof sap.ui.core.Title)){return true;}else{f.setVisible(true);}}});}else if(this.getChangeType()==="removeSimpleFormGroup"){var t=sap.ui.getCore().byId(this.getGroupId());this.getElement().insertContent(t,this.getGroupIndex());if((this.getGroupIndex()===0)&&(this.getNextGroupIndex()>0)){var n=e.removeContent(1);e.insertContent(n,this.getNextGroupIndex());}this.getFields().forEach(function(f){f.setVisible(true);});this.setOriginalElement(t);}};b.prototype.serialize=function(){return this._getSpecificChangeInfo(b.FORWARD);};return b;},true);
