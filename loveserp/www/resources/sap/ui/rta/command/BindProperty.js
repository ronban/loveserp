/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
sap.ui.define(['sap/ui/rta/command/FlexCommand',"sap/ui/fl/changeHandler/PropertyBindingChange","sap/ui/rta/Utils"],function(F,P,U){"use strict";var B=F.extend("sap.ui.rta.command.BindProperty",{metadata:{library:"sap.ui.rta",properties:{propertyName:{type:"string"},newBinding:{type:"string",bindable:false},oldValue:{type:"any"},oldBinding:{type:"string"},changeType:{type:"string",defaultValue:"propertyBindingChange"}},associations:{},events:{}}});B.prototype.init=function(){this.setChangeHandler(P);};B.FORWARD=true;B.BACKWARD=false;B.prototype.bindProperty=function(n,b){if(n==="newBinding"){return this.setNewBinding(b.bindingString);}if(n==="oldBinding"){return this.setOldBinding(b.bindingString);}return F.prototype.bindProperty.apply(this,arguments);};B.prototype._ensureOld=function(){if((this.getOldValue()===undefined)&&(this.getOldBinding()===undefined)){var e=this._getElement();var b=e.getBindingInfo(this.getPropertyName());if(b&&b.bindingString){this.setOldBinding(b.bindingString);}else{var o=U.getPropertyValue(e,this.getPropertyName());this.setOldValue(o);}}};B.prototype._getOld=function(){if(this.getOldValue()==="undefined"){return this.getOldValue();}else{return this.getOldBinding();}};B.prototype._getSpecificChangeInfo=function(f){var e=this._getElement();this._ensureOld();var s={changeType:this.getChangeType(),selector:{id:e.getId(),type:e.getMetadata().getName()},content:{property:this.getPropertyName(),newBinding:f?this.getNewBinding():this._getOld()}};if(f&&typeof this.getOldValue()!=="undefined"){s.content.oldValue=this.getOldValue();}else{s.content.oldBinding=f?this.getOldBinding():this.getNewBinding();}return s;};B.prototype._getFlexChange=function(f){var s=this._getSpecificChangeInfo(f);var c=this._completeChangeContent(s);return{change:c,selectorElement:this._getElement()};};B.prototype._getForwardActionData=function(e){return this._getFlexChange(B.FORWARD);};B.prototype._getBackwardActionData=function(e){return this._getFlexChange(B.BACKWARD);};B.prototype.serialize=function(){return this._getSpecificChangeInfo(B.FORWARD);};return B;},true);
